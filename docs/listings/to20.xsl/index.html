
<!DOCTYPE html>
<html lang="en">
<head>
<title>to20.xsl | MusicXML 4.0</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width">
<link rel="stylesheet" href="../../static/styles.css">

</head>

<body class="has-sidenav">
<div class="topnav">
    <button id="toggle" class="toggle">
        <svg viewBox="0 0 100 80" width="16" height="16" fill="currentColor">
          <rect width="100" height="20" rx="8"></rect>
          <rect y="30" width="100" height="20" rx="8"></rect>
          <rect y="60" width="100" height="20" rx="8"></rect>
        </svg>
    </button>
    <a class="logo" href="../../">
        <span class="logo-text">MusicXML 4.0</span>
    </a>
</div>


<div class="content">
    <nav class="sidenav">
        <img src="/musicxml/static/images/back-cg-draft.png"/>
<ul>
    <li><b><a href="../../"/>Introduction</a></b></li>
    <li><b><a href="../../tutorial/introduction/">Tutorial</a></b></li>
    <ul>
        <li><a href="../../tutorial/hello-world/">"Hello World"</a></li>
        <li><a href="../../tutorial/structure-of-musicxml-files/">File Structure</a></li>
        <li><a href="../../tutorial/midi-compatible-part/">MIDI-Compatible Part</a></li>
        <li><a href="../../tutorial/notation-basics/">Notation Basics</a></li>
        <li><a href="../../tutorial/chord-symbols-and-diagrams/">Chord Symbols</a></li>
        <li><a href="../../tutorial/tablature/">Tablature</a></li>
        <li><a href="../../tutorial/percussion/">Percussion</a></li>
        <li><a href="../../tutorial/compressed-mxl-files/">Compressed .MXL Files</a></li>
        <li><a href="../../tutorial/code-generation/">Code Generation</a></li>
    </ul>
    <li><b><a href="../../musicxml-reference/">MusicXML Reference</a></b></li>
    <ul>
        <li><a href="../../musicxml-reference/elements/">Elements</a></li>
        <li><a href="../../musicxml-reference/data-types/">Data Types</a></li>
        <li><a href="../../musicxml-reference/examples/">Examples</a></li>
    </ul>
    <li><b><a href="../../container-reference/">Container Reference</a></b></li>
    <ul>
        <li><a href="../../container-reference/elements/">Elements</a></li>
        <li><a href="../../container-reference/examples/">Examples</a></li>
    </ul>
    <li><b><a href="../../opus-reference/">Opus Reference</a></b></li>
    <ul>
        <li><a href="../../opus-reference/elements/">Elements</a></li>
        <li><a href="../../opus-reference/data-types/">Data Types</a></li>
        <li><a href="../../opus-reference/examples/">Examples</a></li>
    </ul>
    <li><b><a href="../../sounds-reference/">Sounds Reference</a></b></li>
    <ul>
        <li><a href="../../sounds-reference/elements/">Elements</a></li>
        <li><a href="../../sounds-reference/data-types/">Data Types</a></li>
        <li><a href="../../sounds-reference/examples/">Examples</a></li>
    </ul>
    <li><b><a href="../overview/">File Listings</a></b></li>
    <ul>
        <li><a href="../musicxml.xsd/">musicxml.xsd</a></li>
        <li><a href="../xlink.xsd/">xlink.xsd</a></li>
        <li><a href="../xml.xsd/">xml.xsd</a></li>
        <li><a href="../container.xsd/">container.xsd</a></li>
        <li><a href="../opus.xsd/">opus.xsd</a></li>
        <li><a href="../sounds.xsd/">sounds.xsd</a></li>
        <li><a href="../sounds.xml/">sounds.xml</a></li>
        <li><a href="../catalog.xml/">catalog.xml</a></li>
        <li><a href="../to31.xsl/">to31.xsl</a></li>
        <li><a href="../to30.xsl/">to30.xsl</a></li>
        <li><a href="./">to20.xsl</a></li>
        <li><a href="../to11.xsl/">to11.xsl</a></li>
        <li><a href="../to10.xsl/">to10.xsl</a></li>
        <li><a href="../parttime.xsl/">parttime.xsl</a></li>
        <li><a href="../timepart.xsl/">timepart.xsl</a></li>
    </ul>
    <li><b><a href="../../version-history/">Version History</a></b></li>
    <ul>
        <li><a href="../../version-history/40/">Version 4.0</a></li>
        <li><a href="../../version-history/31/">Version 3.1</a></li>
        <li><a href="../../version-history/30/">Version 3.0</a></li>
        <li><a href="../../version-history/20/">Version 2.0</a></li>
        <li><a href="../../version-history/11/">Version 1.1</a></li>
        <li><a href="../../version-history/10/">Version 1.0</a></li>
    </ul>
</ul>
    </nav>
    <main>
    
<p class="breadcrumb">
    <a href="../../">MusicXML 4.0</a> &gt;
    <a href="../">File Listings</a> &gt;
    to20.xsl
</p>

<h1>to20.xsl</h1>

<p><pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;!--
  MusicXML to20.xsl stylesheet

  Version 4.0

  Copyright Â© 2004-2021 the Contributors to the MusicXML 
  Specification, published by the W3C Music Notation Community
  Group under the W3C Community Final Specification Agreement 
  (FSA): 

     https://www.w3.org/community/about/agreements/final/

  A human-readable summary is available:

     https://www.w3.org/community/about/agreements/fsa-deed/
--&gt;

&lt;!--
  To20.xsl converts from MusicXML 3.0 to 2.0 for
  compatibility with older products.
--&gt;

&lt;xsl:stylesheet
  version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&gt;

  &lt;!--
    XML output, with a DOCTYPE referring the partwise DTD.
    Here we use the full Internet URL.
  --&gt;

  &lt;xsl:output method="xml" indent="yes" encoding="UTF-8"
    omit-xml-declaration="no" standalone="no"
    doctype-system="http://www.musicxml.org/dtds/partwise.dtd"
    doctype-public="-//Recordare//DTD MusicXML 2.0 Partwise//EN"/&gt;

  &lt;!--
    For the root, only look for score-partwise. Anything else 
    as a root element gets ignored.
  --&gt;  
  &lt;xsl:template match="/"&gt;
    &lt;xsl:apply-templates select="./score-partwise"/&gt;
  &lt;/xsl:template&gt;

  &lt;!--
    Transformations that remove post-2.0 elements and 
    attributes.
  --&gt;
  
  &lt;!-- Additions in note.mod --&gt;
  &lt;xsl:template 
    match="notehead-text |
      tied/@dash-length | tied/@space-length |
      slur/@dash-length | slur/@space-length |
      glissando/@dash-length | glissando/@space-length |
      slide/@dash-length | slide/@space-length |
      scoop/@dash-length | scoop/@space-length |
      plop/@dash-length | plop/@space-length |
      doit/@dash-length | doit/@space-length |
      falloff/@dash-length | falloff/@space-length |
      extend/@default-x | extend/@default-y |
      extend/@relative-x | extend/@relative-y |
      extend/@type | rest/@measure | 
      breath-mark/text() | tie/@time-only |
      turn/@slash | delayed-turn/@slash |
      inverted-turn/@slash | delayed-inverted-turn |
      vertical-turn | hole | arrow | handbell | 
      mordent/@approach | inverted-mordent/@approach |
      mordent/@departure | inverted-mordent/@departure |
      notations/@print-object | lyric/@print-object"/&gt;

  &lt;!--
    Remove accidental and accidental-mark elements with 
    new values.
  --&gt;
  &lt;xsl:template 
    match="accidental[. = 'sharp-down' or . = 'sharp-up' or 
        . = 'natural-down' or . = 'natural-up' or 
        . = 'flat-down' or . = 'flat-up' or
        . = 'triple-sharp' or . = 'triple-flat' or
        . = 'slash-quarter-sharp' or . = 'slash-sharp' or
        . = 'slash-flat' or . = 'double-slash-flat' or
        . = 'sharp-1' or . = 'sharp-2' or
        . = 'sharp-3' or . = 'sharp-5' or
        . = 'flat-1' or . = 'flat-2' or
        . = 'flat-3' or . = 'flat-4' or
        . = 'sori' or . = 'koron']"/&gt;

  &lt;xsl:template 
    match="accidental-mark[. = 'sharp-down' or . = 'sharp-up' or 
        . = 'natural-down' or . = 'natural-up' or 
        . = 'flat-down' or . = 'flat-up' or
        . = 'triple-sharp' or . = 'triple-flat' or
        . = 'slash-quarter-sharp' or . = 'slash-sharp' or
        . = 'slash-flat' or . = 'double-slash-flat' or
        . = 'sharp-1' or . = 'sharp-2' or
        . = 'sharp-3' or . = 'sharp-5' or
        . = 'flat-1' or . = 'flat-2' or
        . = 'flat-3' or . = 'flat-4' or
        . = 'sori' or . = 'koron']"/&gt;

  &lt;!-- Remove type elements with new values. --&gt;
  &lt;xsl:template 
    match="type[. = '1024th' or . = '512th' or 
        . = 'maxima']"/&gt; 

  &lt;!-- Remove notehead elements with new values. --&gt;
  &lt;xsl:template 
    match="notehead[. = 'fa up' or . = 'circle dot' or 
          . = 'left triangle' or . = 'rectangle']"/&gt; 

  &lt;!-- Remove beam element with new number values --&gt;
  &lt;xsl:template 
    match="beam[@number[. = '7' or . = '8']]"/&gt;

  &lt;!-- Remove tremolo element with new number values --&gt;
  &lt;xsl:template 
    match="tremolo[. = '7' or . = '8']"/&gt;

  &lt;!-- 
    Remove tied elements with new continue value for the 
    for the type attribute.
  --&gt;
  &lt;xsl:template 
    match="tied[@type[. = 'continue']]"/&gt;

  &lt;!-- Additions in attributes.mod --&gt;

  &lt;xsl:template 
    match="key-accidental | interchangeable | 
      senza-misura/text() | transpose/@number |
      time/@halign | time/@valign |
      time/@separator | clef/@after-barline"/&gt;

  &lt;!-- Remove cancel location attribute with new values --&gt;
  &lt;xsl:template 
    match="cancel/@location[. = 'before-barline']"/&gt;

  &lt;!-- Remove time symbol attribute with new values --&gt;
  &lt;xsl:template 
    match="time/@symbol[. = 'note' or . = 'dotted-note']"/&gt;

  &lt;!-- Remove all but first transpose element --&gt;
  &lt;xsl:template 
    match="attributes/transpose[position() &gt; 1]"/&gt;

  &lt;!-- Remove jianpu clefs altogether --&gt;
  &lt;xsl:template 
    match="clef[//sign[.='jianpu']]"/&gt;

  &lt;!-- Remove part-symbol element with new square value --&gt;
  &lt;xsl:template 
    match="part-symbol[.='square']"/&gt;

  &lt;!-- Additions in barline.mod --&gt;
  &lt;xsl:template 
    match="repeat/@winged"/&gt;

  &lt;!-- Additions in common.mod --&gt;

  &lt;xsl:template 
    match="dynamics/@halign | dynamics/@valign |
      dynamics/@underline | dynamics/@overline |
      dynamics/@line-through | dynamics/@enclosure |
      coda/@halign | coda/@valign |
      segno/@halign | segno/@valign |
      midi-device/@id | play | @xml:space"/&gt;
  
  &lt;!-- 
    Remove display-text and accidental-text enclosure 
    attributes that have values of square, circle, or bracket.
  --&gt;
  &lt;xsl:template 
    match="display-text/@enclosure[. = 'square' or . = 'circle' or
                   . = 'bracket' or . = 'triangle' or
                   . = 'diamond'] "/&gt;
  &lt;xsl:template 
    match="accidental-text/@enclosure[. = 'square' or . = 'circle' or
                    . = 'bracket' or . = 'triangle' or
                    . = 'diamond'] "/&gt;

  &lt;!-- Remove accidental-text elements with new values. --&gt;
  &lt;xsl:template 
    match="accidental-text[. = 'sharp-down' or . = 'sharp-up' or 
        . = 'natural-down' or . = 'natural-up' or 
        . = 'flat-down' or . = 'flat-up' or
        . = 'triple-sharp' or . = 'triple-flat' or
        . = 'slash-quarter-sharp' or . = 'slash-sharp' or
        . = 'slash-flat' or . = 'double-slash-flat' or
        . = 'sharp-1' or . = 'sharp-2' or
        . = 'sharp-3' or . = 'sharp-5' or
        . = 'flat-1' or . = 'flat-2' or
        . = 'flat-3' or . = 'flat-4' or
        . = 'sori' or . = 'koron']"/&gt;

  &lt;!-- Additions in direction.mod --&gt;

  &lt;xsl:template 
    match="rehearsal/@justify | rehearsal/@halign |
      rehearsal/@valign | rehearsal/@letter-spacing |
      rehearsal/@line-height | 
      wedge/@line-type | wedge/@niente |
      wedge/@dash-length | wedge/@space-length |
      bracket/@dash-length | bracket/@space-length |
      dashes/@dash-length | dashes/@space-length |
      octave-shift/@dash-length | octave-shift/@space-length |
      accordion-registration/@halign | accordion-registration/@valign |
      damp/@halign | damp/@valign |
      damp-all/@halign | damp-all/@valign |
      eyeglasses/@halign | eyeglasses/@valign |
      harp-pedals/@halign | harp-pedals/@valign |
      pedal/@halign | pedal/@valign | pedal/@sign |
      other-direction/@halign | other-direction/@valign |
      measure-numbering/@halign | measure-numbering/@valign |
      metronome/@halign | metronome/@valign |
      metronome/@justify | frame/@unplayed |
      degree-value/@symbol | sound/midi-device"/&gt;

  &lt;!-- 
    For safety, remove entire direction that has a new 
    continue value for the type attribute.
  --&gt;
  &lt;xsl:template 
    match="direction[direction-type[wedge[@type[. = 'continue']]]]"/&gt;

  &lt;xsl:template 
    match="direction[direction-type[dashes[@type[. = 'continue']]]]"/&gt;

  &lt;xsl:template 
    match="direction[direction-type[bracket[@type[. = 'continue']]]]"/&gt;

  &lt;xsl:template 
    match="direction[direction-type[octave-shift[@type[. = 'continue']]]]"/&gt;

  &lt;xsl:template 
    match="direction[direction-type[pedal[@type[. = 'continue']]]]"/&gt;

  &lt;!-- 
    For safety, remove entire direction that has a new
    MusicXML 3.0 direction-type child.
  --&gt;
  &lt;xsl:template 
    match="direction[direction-type[string-mute]]"/&gt;

  &lt;xsl:template 
    match="direction[direction-type[principal-voice]]"/&gt;

  &lt;xsl:template 
    match="direction[direction-type[percussion]]"/&gt;

  &lt;!-- 
    Remove rehearsal enclosure attributes that have values
    of rectangle, oval, bracket, triangle, or diamond.
  --&gt;
  &lt;xsl:template 
    match="rehearsal/@enclosure[. = 'rectangle' or . = 'oval' or
              . = 'bracket' or . = 'triangle' or
              . = 'diamond'] "/&gt;

  &lt;!-- 
    Remove words enclosure attributes that have values
    of square, circle, bracket, triangle, or diamond.
  --&gt;
  &lt;xsl:template 
    match="words/@enclosure[. = 'square' or . = 'circle' or
              . = 'bracket' or . = 'triangle' or
              . = 'diamond'] "/&gt;

  &lt;!-- Remove metronome-beam element with new number values --&gt;
  &lt;xsl:template 
    match="metronome-beam[@number[. = '7' or . = '8']]"/&gt;

  &lt;!-- Additions in layout.mod --&gt;
  &lt;xsl:template 
    match="distance | system-dividers"/&gt;
  
  &lt;!-- Additions in score.mod --&gt;

  &lt;xsl:template 
    match="credit-type | instrument-sound | virtual-instrument"/&gt;
  
  &lt;!-- Remove all but first midi-device element --&gt;
  &lt;xsl:template 
    match="score-part/midi-device[position() &gt; 1]"/&gt;

  &lt;!-- Remove group-symbol element with new square value --&gt;
  &lt;xsl:template 
    match="group-symbol[.='square']"/&gt;

  &lt;!-- 
    Remove credit-words enclosure attributes that have
    values of square, circle, bracket, triangle, or diamond.
  --&gt;
  &lt;xsl:template 
    match="credit-words/@enclosure[. = 'square' or . = 'circle' or
                   . = 'bracket' or . = 'triangle' or
                   . = 'diamond'] "/&gt;

  &lt;!--
    Convert score version attribute to 2.0
  --&gt;
  &lt;xsl:template 
    match="score-partwise/@version"&gt;
    &lt;xsl:attribute name="version"&gt;2.0&lt;/xsl:attribute&gt;
  &lt;/xsl:template&gt;

  &lt;!--
    The identity transformation. Used for everything that
    stays the same in 2.0.
  --&gt;

  &lt;xsl:template match="text()"&gt;
    &lt;xsl:value-of select="." /&gt;
  &lt;/xsl:template&gt;
  
  &lt;!--
    Whitespace within an xsl:copy could cause problems with 
    empty elements.
  --&gt;
  &lt;xsl:template match="*|@*|comment()|processing-instruction()"&gt;
    &lt;xsl:copy&gt;&lt;xsl:apply-templates
        select="*|@*|comment()|processing-instruction()|text()"
    /&gt;&lt;/xsl:copy&gt;
  &lt;/xsl:template&gt;

&lt;/xsl:stylesheet&gt;</pre></p>

    </main>
</div>


<script type="text/javascript" src="../../static/global.js"></script>

</body>
</html>
